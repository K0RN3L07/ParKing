<link rel="stylesheet" href="/css/myBookings.css">
<script src="/js/myBookings.js" defer></script>
<%- include('layout', {body: '' }) %>

    <!-- #region Dark Mode Toggling Button -->
    <button id="dark-mode-switch" onclick="toggleDarkMode()">
        <svg xmlns="http://www.w3.org/2000/svg" height="30px" viewBox="0 -960 960 960" width="30px" fill="#1f1f1f">
            <path
                d="M480-120q-150 0-255-105T120-480q0-150 105-255t255-105q14 0 27.5 1t26.5 3q-41 29-65.5 75.5T444-660q0 90 63 153t153 63q55 0 101-24.5t75-65.5q2 13 3 26.5t1 27.5q0 150-105 255T480-120Zm0-80q88 0 158-48.5T740-375q-20 5-40 8t-40 3q-123 0-209.5-86.5T364-660q0-20 3-40t8-40q-78 32-126.5 102T200-480q0 116 82 198t198 82Zm-10-270Z" />
        </svg>
    </button>
    <!-- #endregion -->

    <!-- #region Navigation Bar -->
    <nav>
        <a href="/" class="logo">
            <img src="/img/full_logo.png" alt="">
        </a>

        <div class="items">
            <a href="/">Főoldal</a>
            <a href="#">Rólunk</a>
            <a href="#">Kapcsolat</a>
            <% if (user) {%>
                <a href="/myBookings">Foglalás</a>
                <%} else {%>
                    <a style="cursor: pointer;" onclick="alert('Jelentkezz be!')">Foglalás</a>
                    <%}%>
        </div>

        <div class="profile-container">

            <% if (user) {%>
                <h2>
                    <%= user.name %>
                </h2>
                <%}%>

                    <div class="profile-icon">
                        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 64 64" width="35" height="35" fill="none"
                            stroke="white" stroke-width="4" stroke-linecap="round" stroke-linejoin="round">
                            <circle cx="32" cy="20" r="12" />
                            <path d="M8 56c0-10.6667 9.6-20 24-20s24 9.3333 24 20" />
                        </svg>

                        <div class="profile-icon-dropdown-container" tabindex="0">
                            <a href="">Fiókom szerkesztése</a>
                            <a>Sötét mód</a>
                            <% if (user) { %>
                                <a href="/logout">Kijelentkezés</a>
                                <% } else { %>
                                    <a href="/login">Bejelentkezés</a>
                                    <% } %>
                        </div>
                    </div>
        </div>

        <div class="hamburger-menu" onclick="toggleHamburgerMenu()">
            <svg xmlns="http://www.w3.org/2000/svg" height="48px" viewBox="0 -960 960 960" width="48px">
                <path d="M120-240v-80h720v80H120Zm0-200v-80h720v80H120Zm0-200v-80h720v80H120Z" />
            </svg>
        </div>

        <div class="items-vertical">
            <a href="/">Főoldal</a>
            <a href="#">Rólunk</a>
            <a href="#">Kapcsolat</a>
            <% if (user) { %>
                <a href="/myBookings">Foglalás</a>
                <% } else { %>
                    <a style="cursor: pointer;" onclick="alert('Jelentkezz be!')">Foglalás</a>
                    <% } %>

                        <div class="my-profile" onclick="toggleProfileDropdown()">
                            <p>Profil</p>

                            <svg id="dropdown-icon" xmlns="http://www.w3.org/2000/svg" height="32px"
                                viewBox="0 -960 960 960" width="32px" fill="var(--primary-text-color)">
                                <path d="M480-344 240-584l56-56 184 184 184-184 56 56-240 240Z" />
                            </svg>
                        </div>

                        <div class="profile-dropdown-conatiner">
                            <a href="">Fiókom szerkesztése</a>
                            <a href="">Sötét mód</a>
                            <% if (user) { %>
                                <a href="/logout">Kijelentkezés</a>
                                <% } else { %>
                                    <a href="/login">Bejelentkezés</a>
                                    <% } %>
                        </div>

        </div>
    </nav>
    <!-- #endregion -->

    <!-- #region My Bookings -->

    <div class="container">
        <h1>Foglalásaim</h1>

        <% if (bookings) {%>
            <table>
                <tr>
                    <th>Emelet</th>
                    <th>Parkolóhely</th>
                    <th>Mettől</th>
                    <th>Meddig</th>
                    <th>Állapot</th>
                    <th>Rendszám</th>
                </tr>

                <% bookings.forEach(booking=> { %>
                    <tr>
                        <td>
                            <%= booking["floor_num"] %>
                        </td>
                        <td>
                            <%= booking["parking_space_num"] %>
                        </td>
                        <% const date1=new Date(booking["start_time"]); const
                            start_formatted=date1.toISOString().slice(0, 10) + ", " + date1.toISOString().slice(11, 16);
                            %>
                            <td>
                                <%= start_formatted %>
                            </td>
                            <% const date2=new Date(booking["end_time"]); const
                                end_formatted=date2.toISOString().slice(0, 10) + ", " + date2.toISOString().slice(11,
                                16); %>
                                <td>
                                    <%= end_formatted %>
                                </td>
                                <td>
                                    <%= booking["parking_status"] %>
                                </td>
                                <td>
                                    <%= booking["plate_num"] %>
                                </td>
                    </tr>
                    <% }) %>
            </table>
            <% } else {%>
                <h2>Még nincs foglalásod!</h2>
                <% } %>

                    <a href="/newBooking" class="add-button">
                        <svg xmlns="http://www.w3.org/2000/svg" height="24px" viewBox="0 -960 960 960" width="24px"
                            fill="#e3e3e3">
                            <path d="M440-440H200v-80h240v-240h80v240h240v80H520v240h-80v-240Z" />
                        </svg>
                        Új foglalás
                    </a>
    </div>


    <!-- #endregion -->