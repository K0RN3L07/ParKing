CREATE DATABASE IF NOT EXISTS parking CHARACTER SET utf8 COLLATE utf8_hungarian_ci;

USE parking;

CREATE TABLE IF NOT EXISTS `users` (
	`id` int AUTO_INCREMENT NOT NULL,
	`name` varchar(255) NOT NULL,
	`email` varchar(255) NOT NULL UNIQUE,
	`phone_num` varchar(255) NOT NULL UNIQUE,
	`password` varchar(255) NOT NULL,
	`registered_at` timestamp NOT NULL DEFAULT CURRENT_TIMESTAMP,
	PRIMARY KEY (`id`)
);

CREATE TABLE IF NOT EXISTS `parking_spaces` (
	`id` int AUTO_INCREMENT NOT NULL,
	`floor_num` int NOT NULL,
	`parking_space_num` int NOT NULL,
	`type` varchar(255) NOT NULL,
	`price_per_hour` int NOT NULL,
	`is_available` boolean NOT NULL,
	PRIMARY KEY (`id`)
);

CREATE TABLE IF NOT EXISTS `bookings` (
	`id` int AUTO_INCREMENT NOT NULL,
	`user_id` int NOT NULL,
	`parking_space_id` int NOT NULL,
	`start_time` datetime NOT NULL,
	`end_time` datetime NOT NULL,
	`parking_status` varchar(255),
	`payment_status` varchar(255) NOT NULL,
	`plate_num` varchar(255) NOT NULL,
	`booked_at` timestamp NOT NULL DEFAULT CURRENT_TIMESTAMP,
	PRIMARY KEY (`id`),
    
    FOREIGN KEY (user_id) REFERENCES users(id)
        ON DELETE CASCADE -- Törlés esetén felülír
        ON UPDATE CASCADE, -- Frissítés esetén felülír

    FOREIGN KEY (parking_space_id) REFERENCES parking_spaces(id)
        ON DELETE CASCADE -- Törlés esetén felülír
        ON UPDATE CASCADE) -- Frissítés esetén felülír
;

INSERT INTO `parking_spaces` (`floor_num`, `parking_space_num`, `type`, `price_per_hour`, `is_available`) VALUES
(1, 1, 'Normal', 400, TRUE),
(1, 2, 'Normal', 400, TRUE),
(1, 3, 'Normal', 400, TRUE),
(1, 4, 'Normal', 400, TRUE),
(1, 5, 'Normal', 400, TRUE),
(1, 6, 'Normal', 400, TRUE),
(1, 7, 'Normal', 400, TRUE),
(1, 8, 'Normal', 400, TRUE),
(1, 9, 'Normal', 400, TRUE),
(1, 10, 'Normal', 400, TRUE),
(1, 11, 'Electric', 600, TRUE),
(1, 12, 'Electric', 600, TRUE),
(1, 13, 'Electric', 600, TRUE),
(1, 14, 'Handicapped', 300, TRUE),
(1, 15, 'Handicapped', 300, TRUE),
(1, 16, 'Electric', 600, TRUE),
(1, 17, 'Electric', 600, TRUE),
(1, 18, 'Electric', 600, TRUE),
(1, 19, 'Handicapped', 300, TRUE),
(1, 20, 'Handicapped', 300, TRUE),

(2, 1, 'Normal', 400, TRUE),
(2, 2, 'Normal', 400, TRUE),
(2, 3, 'Normal', 400, TRUE),
(2, 4, 'Normal', 400, TRUE),
(2, 5, 'Normal', 400, TRUE),
(2, 6, 'Normal', 400, TRUE),
(2, 7, 'Normal', 400, TRUE),
(2, 8, 'Normal', 400, TRUE),
(2, 9, 'Normal', 400, TRUE),
(2, 10, 'Normal', 400, TRUE),
(2, 11, 'Electric', 600, TRUE),
(2, 12, 'Electric', 600, TRUE),
(2, 13, 'Electric', 600, TRUE),
(2, 14, 'Handicapped', 300, TRUE),
(2, 15, 'Handicapped', 300, TRUE),
(2, 16, 'Electric', 600, TRUE),
(2, 17, 'Electric', 600, TRUE),
(2, 18, 'Electric', 600, TRUE),
(2, 19, 'Handicapped', 300, TRUE),
(2, 20, 'Handicapped', 300, TRUE),

(3, 1, 'Normal', 400, TRUE),
(3, 2, 'Normal', 400, TRUE),
(3, 3, 'Normal', 400, TRUE),
(3, 4, 'Normal', 400, TRUE),
(3, 5, 'Normal', 400, TRUE),
(3, 6, 'Normal', 400, TRUE),
(3, 7, 'Normal', 400, TRUE),
(3, 8, 'Normal', 400, TRUE),
(3, 9, 'Normal', 400, TRUE),
(3, 10, 'Normal', 400, TRUE),
(3, 11, 'Electric', 600, TRUE),
(3, 12, 'Electric', 600, TRUE),
(3, 13, 'Electric', 600, TRUE),
(3, 14, 'Handicapped', 300, TRUE),
(3, 15, 'Handicapped', 300, TRUE),
(3, 16, 'Electric', 600, TRUE),
(3, 17, 'Electric', 600, TRUE),
(3, 18, 'Electric', 600, TRUE),
(3, 19, 'Handicapped', 300, TRUE),
(3, 20, 'Handicapped', 300, TRUE),

(4, 1, 'Normal', 400, TRUE),
(4, 2, 'Normal', 400, TRUE),
(4, 3, 'Normal', 400, TRUE),
(4, 4, 'Normal', 400, TRUE),
(4, 5, 'Normal', 400, TRUE),
(4, 6, 'Normal', 400, TRUE),
(4, 7, 'Normal', 400, TRUE),
(4, 8, 'Normal', 400, TRUE),
(4, 9, 'Normal', 400, TRUE),
(4, 10, 'Normal', 400, TRUE),
(4, 11, 'Electric', 600, TRUE),
(4, 12, 'Electric', 600, TRUE),
(4, 13, 'Electric', 600, TRUE),
(4, 14, 'Handicapped', 300, TRUE),
(4, 15, 'Handicapped', 300, TRUE),
(4, 16, 'Electric', 600, TRUE),
(4, 17, 'Electric', 600, TRUE),
(4, 18, 'Electric', 600, TRUE),
(4, 19, 'Handicapped', 300, TRUE),
(4, 20, 'Handicapped', 300, TRUE),

(5, 1, 'Normal', 400, TRUE),
(5, 2, 'Normal', 400, TRUE),
(5, 3, 'Normal', 400, TRUE),
(5, 4, 'Normal', 400, TRUE),
(5, 5, 'Normal', 400, TRUE),
(5, 6, 'Normal', 400, TRUE),
(5, 7, 'Normal', 400, TRUE),
(5, 8, 'Normal', 400, TRUE),
(5, 9, 'Normal', 400, TRUE),
(5, 10, 'Normal', 400, TRUE),
(5, 11, 'Electric', 600, TRUE),
(5, 12, 'Electric', 600, TRUE),
(5, 13, 'Electric', 600, TRUE),
(5, 14, 'Handicapped', 300, TRUE),
(5, 15, 'Handicapped', 300, TRUE),
(5, 16, 'Electric', 600, TRUE),
(5, 17, 'Electric', 600, TRUE),
(5, 18, 'Electric', 600, TRUE),
(5, 19, 'Handicapped', 300, TRUE),
(5, 20, 'Handicapped', 300, TRUE);